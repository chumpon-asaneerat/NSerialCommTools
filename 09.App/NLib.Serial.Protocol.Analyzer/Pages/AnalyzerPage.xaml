<UserControl x:Class="NLib.Serial.Protocol.Analyzer.Pages.AnalyzerPage"
             xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
             xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
             mc:Ignorable="d"
             d:DesignHeight="600" d:DesignWidth="1000">

    <UserControl.Resources>
        <Style x:Key="RightAlignedTextBlockStyle" TargetType="TextBlock">
            <Setter Property="HorizontalAlignment" Value="Right"/>
            <Setter Property="Margin" Value="0,0,5,0"/>
        </Style>
    </UserControl.Resources>

    <ScrollViewer VerticalScrollBarVisibility="Auto" HorizontalScrollBarVisibility="Auto">
        <DockPanel Margin="10">

            <!-- ACTION BUTTONS (Top) -->
            <StackPanel DockPanel.Dock="Top" Orientation="Horizontal" Margin="0,0,0,10">
                <Button x:Name="RunAnalysisButton"
                        Content="ðŸ”¬ Run Analysis"
                        Width="130"
                        Height="35"
                        Margin="0,0,10,0"/>
                <TextBlock x:Name="AnalysisStatusText"
                           Text="Click 'Run Analysis' to start"
                           VerticalAlignment="Center"
                           FontStyle="Italic"
                           Foreground="Gray"/>
            </StackPanel>

            <!-- OVERALL CONFIDENCE (Top) -->
            <GroupBox DockPanel.Dock="Top" Header="ðŸ“ˆ Overall Analysis Confidence" Margin="0,0,0,10">
                <StackPanel Margin="5">
                    <StackPanel Orientation="Horizontal" Margin="0,0,0,5">
                        <TextBlock Text="Confidence: " FontWeight="Bold"/>
                        <TextBlock x:Name="ConfidenceText" Text="0%" FontWeight="Bold"/>
                    </StackPanel>
                    <ProgressBar x:Name="ConfidenceProgressBar" Height="25" Minimum="0" Maximum="100" Value="0"/>
                </StackPanel>
            </GroupBox>

            <!-- FIELD PREVIEW (Bottom) -->
            <GroupBox DockPanel.Dock="Bottom" Header="ðŸ“Š Detected Fields Preview" Margin="0,10,0,0">
                <DockPanel>
                    <Border DockPanel.Dock="Bottom" Background="#FFFACD" Padding="5" Margin="0,5,0,0">
                        <TextBlock Text="ðŸ’¡ Variance: Low=constant, High=data field" FontStyle="Italic"/>
                    </Border>
                    <DataGrid x:Name="FieldsPreviewDataGrid"
                              AutoGenerateColumns="False"
                              IsReadOnly="True"
                              HeadersVisibility="Column"
                              Height="200">
                        <DataGrid.Columns>
                            <DataGridTextColumn Header="Pos" Width="50" Binding="{Binding Position}"
                                                ElementStyle="{StaticResource RightAlignedTextBlockStyle}"/>
                            <DataGridTextColumn Header="Name" Width="120" Binding="{Binding Name}"/>
                            <DataGridTextColumn Header="Type" Width="100" Binding="{Binding DataType}"/>
                            <DataGridTextColumn Header="Sample Values" Width="*" Binding="{Binding SampleValuesText}"/>
                            <DataGridTextColumn Header="Conf%" Width="70" Binding="{Binding ConfidenceText}"
                                                ElementStyle="{StaticResource RightAlignedTextBlockStyle}"/>
                            <DataGridTextColumn Header="Var" Width="70" Binding="{Binding VarianceText}"
                                                ElementStyle="{StaticResource RightAlignedTextBlockStyle}"/>
                        </DataGrid.Columns>
                    </DataGrid>
                </DockPanel>
            </GroupBox>

            <!-- DETECTION RESULTS (Center - 3 panels side-by-side) -->
            <StackPanel Orientation="Horizontal" HorizontalAlignment="Center" Margin="0,0,0,10">

                <!-- Panel 1: Terminator Detection -->
                <GroupBox Header="ðŸ”š Terminator" Width="280" Margin="0,0,10,0">
                    <StackPanel Margin="5">
                        <DockPanel Margin="0,0,0,5">
                            <TextBlock Text="Hex Bytes:" FontWeight="Bold" Width="80"/>
                            <TextBlock x:Name="TerminatorHexText" Text="-" TextWrapping="Wrap"/>
                        </DockPanel>
                        <DockPanel Margin="0,0,0,5">
                            <TextBlock Text="Text:" FontWeight="Bold" Width="80"/>
                            <TextBlock x:Name="TerminatorTextRepText" Text="-" TextWrapping="Wrap"/>
                        </DockPanel>
                        <DockPanel Margin="0,0,0,5">
                            <TextBlock Text="Occurs:" FontWeight="Bold" Width="80"/>
                            <TextBlock x:Name="TerminatorOccursText" Text="-"/>
                        </DockPanel>
                        <DockPanel>
                            <TextBlock Text="Confidence:" FontWeight="Bold" Width="80"/>
                            <TextBlock x:Name="TerminatorConfText" Text="-"/>
                        </DockPanel>
                    </StackPanel>
                </GroupBox>

                <!-- Panel 2: Delimiter Detection -->
                <GroupBox Header="âœ‚ï¸ Delimiter" Width="300" Margin="0,0,10,0">
                    <StackPanel Margin="5">
                        <DockPanel Margin="0,0,0,5">
                            <TextBlock Text="Delimiter:" FontWeight="Bold" Width="80"/>
                            <TextBlock x:Name="DelimiterHexText" Text="-" TextWrapping="Wrap"/>
                        </DockPanel>
                        <DockPanel Margin="0,0,0,5">
                            <TextBlock Text="Text:" FontWeight="Bold" Width="80"/>
                            <TextBlock x:Name="DelimiterTextRepText" Text="-" TextWrapping="Wrap"/>
                        </DockPanel>
                        <DockPanel>
                            <TextBlock Text="Frequency:" FontWeight="Bold" Width="80"/>
                            <TextBlock x:Name="DelimiterFreqText" Text="-"/>
                        </DockPanel>
                    </StackPanel>
                </GroupBox>

                <!-- Panel 3: Protocol Type -->
                <GroupBox Header="ðŸ“‹ Protocol Type" Width="260">
                    <StackPanel Margin="5">
                        <DockPanel Margin="0,0,0,5">
                            <TextBlock Text="Type:" FontWeight="Bold" Width="80"/>
                            <TextBlock x:Name="ProtocolTypeText" Text="-" TextWrapping="Wrap"/>
                        </DockPanel>
                        <DockPanel Margin="0,0,0,5">
                            <TextBlock Text="Strategy:" FontWeight="Bold" Width="80"/>
                            <TextBlock x:Name="StrategyText" Text="-" TextWrapping="Wrap"/>
                        </DockPanel>
                        <DockPanel>
                            <TextBlock Text="Fields:" FontWeight="Bold" Width="80"/>
                            <TextBlock x:Name="FieldCountText" Text="-"/>
                        </DockPanel>
                    </StackPanel>
                </GroupBox>

            </StackPanel>

        </DockPanel>
    </ScrollViewer>
</UserControl>
